language: node_js
node_js:
- '8'
dist: trusty
services:
- mongodb
- redis-server
env:
  matrix:
  - NODE_ENV=ci PORT=3000
  global:
  - secure: pyRJV+DSg64IObsNGi1SJ2JJ/SXLWB7Hbi09eFkw1f/nBugrLDGSwYvIi6yIq1S/IkRiXEvjVguJJ9IcMgb8nl8kJe2pxmPFPHAXklFDI4w2uZG8G0x55fkYrBrfspKfOtM3IFAu/4O16/5pcL9MiCRKQdofFlvatAe8y6N27+DkvDUkEnJveqSE8J1VGBreiJHFq7qTV3OuaQtDAVQ20Ku7OCV1tOuGk+e1brtHXHSey4o1rGoWHl/RMpYicb4wTLmmnsM8l+cVmydOQOOmkjzERbeZBtN6F4osZaCj4glEDvkdrUYok7Uvq8siDzqZFphkycliNfMrKAo7wjBSoxATHE6O15e/0hujNzeD5uL2w2eXG9MBj0pwFoWLQUv8/ntJFSNzUuwy02X8jcjduA7jPvzvbM6c+i2qx3fxl/uFnNFV+NNcuc/9Bd7T6M24ESpgcg30J9PCP/oosgH6ragdbfju/sG+rlCvrJsz4Jg3KKTWEQsOLBchN/fF/mOY9lABHYS9xAJEGcOTYcL9kVYfP2jLZOcQiJwoF8w9FbUV59cEnqtXn4f5LNzstg6I1GF4aDPaMYitgLR/hMouNfoxt+012xYkGmAR0LF02BkEwOQlbsTli0ZdaNuJgpDOdKZ4ppgEBHd+DeK/nnB084kAPN8P/nAwCJ1RpPSphT0=
  - secure: xlmS3+ZV/jIAEigGzEWDVHO+YVobGu+/Qy2EHmtO1BOil2SULuWBRMGlL9JRKWC0gSXsEXPXEDJQ+pgqmpvJsFsAjb6dnPqQfaSI0fRJ0FrmLxHyWtscFC05ECiMp837L+B1Og8z0CLUoUWD1UfqR2wltlXuwjmG7SKoCy+a5BqPuM5V7hOif0oSjpJFWfwnpWiVBBuOaMbMaICZHQy2a5hX1XmglA6p/MAyVmFCclSeT8jsPnDMYSRpR6hV6ErYzjBpNVcEa6GV3ZUviQHaDgiGfVCwfCZ6NmEwP2kdJBxbvmnUoLFT31hc+zvSzpvZqnfdg8QWgayhxQ9MqaSlzXva7jqEpizQ4bBKHbokBIcJeDkjQKiP2TN8zSsG2+M9qrtzm6qIdR3E0PBmqBn3t12yhu4UeTZO5D4rHLCnmvUDFmkX5Ui2CYbj0PWwWgJy/NHvJTM/nrNp8j7WOgCDkXMX+Uwui8dKWF9OOqI/c/ZW0xnJL/TWVd2ZkEV50O4h61h+0FokUPAoAIYwJtgQ3kNflgeVI5baaKKhTSau3BRIqz6m0i3ZpcCCuNkZhS3VYKT3wwZ7H5FP4twqi3Ykqv2w9HeSftQeCAB/pr7jWesDcU1Vqz1pJc+VVURK0wz5qrD9dHdYySRRfVx6d/bVge24Y764iAm4m0SZpecJzCE=
  - secure: fmhPwaaTKEQxYRMDEh/y/L0I8I7yS5Ci+OT5My8koQqeIExw/gEfeQJWXmmEuvbguoKuMw6Lcf2RFWhkSWUy3Ysj2PiYrMJE1cPgE/3LcTxiW27TQf49z7uFOHJPscCJ9ieJPmhKuYkZpPLbC5Pu+W6vsmctDQIIV2QM/fPF8k7Lv2kQk450qwOgU6w3bSwoqwSPfbfsBooS3jf0O2r3KHuvMiUdjRkUEaaGbOL3Qj0YyT015tj94yRM3QSrmkK2e+mXF36rtnimH4EMcX2BGTMzDyiIbhbFy99As9lxJ//b7etDjhhkTu53S4dJYLoHX2E7PCQ5bGDPrENE2AvgOpESHfY3zkHG4pLcnKBU9M5MNX8Hh45fgRsdzH3uiR2wHVXgpIGcgdaoi8+86gutBMyx9IS0OnsKzGieTZ7mka9iIUrPZg2yqXV2M/0YEaYto1XT/4p/XamDq/SNzW1/UAZqEp5QB21C7hltPjvYFojVLSZZTaPPdfXy9b1DVSr8z81/VycsC8iB05MJGE+H8yHMJTdOW8ZWbMTsSikcPkxDR5Qk2ayhInpdnvhw4asyxQZVBAnLMD3IQrEvdQflczGAbs1pt7krFfHqvSLm2lZ9MEbez36rZXSE5xf5Ebh+/0d9WlkZF1feGeo7cE8pqju4hw3hp4KnpQmRN+I9CA4=
  - secure: MAtatKa/9huo+IDJwBfQ9kWVVGXNMrUfw6A1YDe7xSzN/62VGDVMvvnFMos4YA8Ze8g3GGenr7SMCMlWyrB6pYO/BumHrohCfbY0PyEJ6HFx8+aOFquwP5U34gZ73+5Lz1sQN4IVj3MP8coFskVMAAmIDecFB7ac1GTy0buLNRhWgKFBPGvLDoCr9OXZ8XYNfGHC03WLOSTNrotYso+kk1se4lZO6B6/sso4bUDnZLnZyiqk4l4vgmPmERXgJp2yWKj0DuSc4CmoHYA7dpwyPGq1MSXY/gxewCGSmQPY+GdDWbkmJGdWsK/t5ixB4Ph6Yo6qin+eKh7WhpSSuKeAUaRV0JvbmBYAVNcvW0OeXM7xNVczOXhH9Z75/vowk68Q1TBB4XKd0Xf9O9QxeoY/LOTusFr5XpvhgExkFUpPgTyYYsq5BWTwxlpldSpfwFG/UUueFpU5eYBQACzOOpRA4phUkKxD2AyAYbETNkuEg8s5ygnE94LCPa6qQxXY5Rx6vZC/FltsLg2MysXrQaZdQARwxQRFXAVRgOwYeXNWU1GAoHCFiAEApD9RF5Vv7bh6Mrby0AcrIbkypXu8XB424iHTohDIjSOat9lOGHgJPqPeKbL9qM20jKcq+6ECT1P0EvE/+cqrbwm7rG4ZJe3AqVhaWfyEiioWj+WRUN1DFGk=
  - secure: kIJ3dIpyPl2n4ffSWhnmFSBlsaNknahP83oAK/osCaKUjkaA9RyvDOAMjESa5P25TKcWAf1MlNEUTod8tkld6RO/PUmH0G0lOJfDHmYQhUFoEMNrUYcdXjAm19eNPq0y+XYmGSj5vzcef14ooWB4TiNxT4ZZbiik5iTESM8Tq7DQK7nEp/V0As96pHuwt9mfqcMVEQWO6FPrneywGmCj7vv/Bn7VoZkiImz6ZGx/LzxcCeeYQsj015d9j0rjUFc780mAY5DcgwfusGbl2thgnxovLe0S3HrtKXDNhYo1qM31nllbEv6kqO8urGfxNdTN+YMEeuCXI8EEhfyEy8uXDvUXqCJuDxxQK7l4KDIJMwjRGECn74inTJ6/NkhmYKwfzN6sGe9kdK3wY6mkgYScVBjJSrHtUYodUyRCumTijzD2WnpROF+tOf+v+Ge3mQ8HfExQJrOphXSH1b7dmwPCAuUZnkSzOypzR67AQIM8uV217JnHr9pg088UYkknpEIp1n6XbnAy0rppUdtiyfGp65lT6SZ5lyq1eKpeX6eaCTxM8sAdzrWlsi+Id4R77J/FzfDZ0CyHub98yDGj0Y/0Wg6TZu4B4AgNU9AsJV0VzrEeYmhiVer2AaeuMUceQ4ALWNJ4K/2cE3383UFqFer/eQsqcIwFBwK/78ammae8ZS8=
cache:
  directories:
  - node_modules
  - client/node_modules
install:
- npm install
- npm run build
script:
- nohup npm run start &
- sleep 3
- npm run test
notifications:
  email:
    on_success: never
